(function(k,p){typeof exports=="object"&&typeof module=="object"?module.exports=p():typeof define=="function"&&define.amd?define([],p):typeof exports=="object"?exports.Slider89=p():k.Slider89=p()})(this,function(){return function(){var V={626:function(u){u.exports=".sl89-track{position:relative;width:200px;height:25px;background-color:hsl(0,0%,18%);}.slider89.vertical .sl89-track{height:200px;width:25px;}.sl89-thumb{position:absolute;width:16px;height:100%;background-color:hsl(0,0%,28%);cursor:pointer;}.slider89.vertical .sl89-thumb{height:16px;width:100%;}.sl89-noselect{-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;pointer-events:none;}"}},k={};function p(u){var c=k[u];if(c!==void 0)return c.exports;var g=k[u]={exports:{}};return V[u](g,g.exports,p),g.exports}(function(){p.n=function(u){var c=u&&u.__esModule?function(){return u.default}:function(){return u};return p.d(c,{a:c}),c}})(),function(){p.d=function(u,c){for(var g in c)p.o(c,g)&&!p.o(u,g)&&Object.defineProperty(u,g,{enumerable:!0,get:c[g]})}}(),function(){p.o=function(u,c){return Object.prototype.hasOwnProperty.call(u,c)}}();var D={};return function(){"use strict";p.d(D,{default:function(){return l}});class u{static getType(e){return Array.isArray(e)?"Array":Number.isNaN(e)?"NaN":e===null?"null":typeof e}static checkTypes(e,t){let s;for(const r of t){const i=r.type;if(i==="boolean"&&typeof e=="boolean"||i==="true"&&e===!0||i==="false"&&e===!1||i==="array"&&Array.isArray(e)||i==="object"&&Object.prototype.toString.call(e)==="[object Object]"||i==="number"&&typeof e=="number"&&!Number.isNaN(e)||i==="function"&&typeof e=="function"||i==="string"&&typeof e=="string"){if(i==="array"){for(const n of e)if(s=u.checkTypes(n,r.descriptor))break}else if(i==="object"){for(const n of Object.values(e))if(s=u.checkTypes(n,r.descriptor))break}if(s)return u.toTitleCase(i)+"<"+s+">";if(s=u.buildConditionTypeMessage(r.conditions,e))break;return!1}}return s||u.getType(e)}static buildConditionTypeMessage(e,t){if(e){if(e.nonnegative&&t<0)return"a negative number";if(e.positive&&t<=0)return"a negative number or 0";if(e.integer&&t%1!==0)return"a floating point number";if(e.filled&&t.trim()==="")return"an empty string";if(e.keywords&&e.keywords.indexOf(t)===-1)return"a different string";if(e.wordChar&&!Number.isNaN(Number(t)))return"a number string";if(e.length&&t.length!==e.length)return"an array of length "+t.length;if(e.nonempty&&t.length===0)return"an empty array"}}static buildDescriptorTypeMessage(e){var t,s,r,i,n,o,h,S;let d="";for(const f of e){const w=f.type;if(d&&(d+=" OR "),w==="number"){const m=(t=f.conditions)==null?void 0:t.nonnegative,O=(s=f.conditions)==null?void 0:s.positive,j=(r=f.conditions)==null?void 0:r.integer;m?d+="non-negative ":O&&(d+="positive "),d+=j?"integer":"number"}else if(w==="array"){const m=u.buildDescriptorTypeMessage(f.descriptor);(i=f.conditions)!=null&&i.nonempty&&(d+="non-empty "),d+="Array<"+m+">",(n=f.conditions)!=null&&n.length&&(d+=" of length "+f.conditions.length)}else if(w==="object"){const m=u.buildDescriptorTypeMessage(f.descriptor);d+="Object<"+f.keyName+", "+m+">"}else w==="string"?(o=f.conditions)!=null&&o.keywords?(f.conditions.keywords.length>1?d+="one of the keywords":d+="the keyword",f.conditions.keywords.forEach(function(m,O,j){O!==0&&O===j.length-1?d+=" or":O!==0&&(d+=","),d+=' "'+m+'"'})):((h=f.conditions)!=null&&h.filled&&(d+="non-empty "),(S=f.conditions)!=null&&S.wordChar&&(d+="non-number "),d+="string"):d+=w;f.shape&&(d+=" ("+f.shape+")")}return d}static toTitleCase(e){return e.slice(0,1).toUpperCase()+e.slice(1)}}const c=class{static getTypeErrorMessage(e,t){return" Expected "+u.buildDescriptorTypeMessage(e)+", got "+t}static getMethodArgMessage(e,t){let s="";return e.optional&&(s+="optional "),s+=l.COUNTS[t]+" argument ("+e.name+")",s}static getMethodArgInfo(e,t){return l.methodData[e].args[t]}static arrayToListString(e){return`
 - "`+e.join(`"
 - "`)+`"
`}};c.COUNTS=["first","second","third","fourth","fifth","sixth","seventh","eighth","ninth"],c.Error=class extends Error{constructor(a,e,t=!1){e&&(a="@ "+e+": "+a),a[a.length-1]!==`
`&&a[a.length-1]!=="."&&(a+="."),t&&(a+=`
Aborting the slider construction.`),super(a),this.name="Slider89"+this.constructor.name}},c.InitializationError=class extends c.Error{constructor(a){super(a,"constructor",!0)}},c.PropertyError=class extends c.Error{constructor(a,e,t){let s=a[e];s!==void 0&&(Array.isArray(s)&&(s="["+s.join(", ")+"]"),t+=`.
Continuing with the previous value (`+s+")."),super(t,e,s===void 0)}},c.PropertyTypeError=class extends c.PropertyError{constructor(a,e,t,s){let r="Type mismatch."+l.getTypeErrorMessage(t.descriptor,s);super(a,e,r)}},c.MethodArgTypeError=class extends c.Error{constructor(a,e,t){const s=l.getMethodArgInfo(a,e),r="Type mismatch on the "+c.getMethodArgMessage(s,e)+"."+l.getTypeErrorMessage(s.descriptor,t);super(r,a)}},c.MethodArgOmitError=class extends c.Error{constructor(a,e){const t=l.getMethodArgInfo(a,e),s="The "+c.getMethodArgMessage(t,e)+" has been omitted but it is required (It must be of type "+u.buildDescriptorTypeMessage(t.descriptor)+").";super(s,a)}},c.StructureError=class extends c.Error{constructor(a){super(a,"structure",!0)}},c.StructureParseError=class extends c.StructureError{constructor(a,e){const t="Something has been declared wrongly and couldn't be parsed. Point of failure (before "+a+`):

`+e+`
`;super(t)}};let g=c;var I;I||(I={});class T extends g{constructor(){super(),this.vals={},this.initial=!1,Object.defineProperties(this.vals,{$:{value:{}},$intermediateThis:{value:{}},$intermediateVals:{value:{}}})}static selfCheckMethod(e,t){const s=this.methodData[e],r=Array.prototype.slice.call(t,0,s.args.length);if(r.forEach((i,n)=>{const o=s.args[n].descriptor,h=u.checkTypes(i,o);if(h)throw new this.MethodArgTypeError(e,n,h)}),s.args[r.length]&&!("optional"in s.args[r.length]))throw new this.MethodArgOmitError(e,r.length)}}T.methodData={addEvent:{args:[{name:"event type",descriptor:[{type:"string"}]},{name:"event function",descriptor:[{type:"function"}]},{name:"event namespace",optional:!0,descriptor:[{type:"string",conditions:{filled:!0,wordChar:!0}}]}]},removeEvent:{args:[{name:"event identifier/namespace",descriptor:[{type:"number",conditions:{nonnegative:!0,integer:!0}},{type:"string",conditions:{filled:!0,wordChar:!0}}]}]}},T.propertyData={range:{isDeepDefinedArray:!0,descriptor:[{type:"array",shape:"[startValue, endValue]",conditions:{length:2},descriptor:[{type:"number"}]},{type:"boolean"}]},values:{isDeepDefinedArray:!0,descriptor:[{type:"array",descriptor:[{type:"number"}]}]},value:{descriptor:[{type:"number"}]},precision:{descriptor:[{type:"number",conditions:{nonnegative:!0,integer:!0}},{type:"false"}]},step:{descriptor:[{type:"number",conditions:{positive:!0}},{type:"array",conditions:{nonempty:!0},descriptor:[{type:"number"}]},{type:"false"}]},structure:{constructorOnly:!0,descriptor:[{type:"string"},{type:"false"}]},node:{readOnly:!0},nodes:{readOnly:!0},orientation:{descriptor:[{type:"string",conditions:{keywords:["horizontal","vertical"]}}]},classList:{constructorOnly:!0,descriptor:[{type:"object",shape:"{nodeName: [...classes]}",keyName:"nodeName",descriptor:[{type:"array",descriptor:[{type:"string"}]}]},{type:"false"}]},events:{constructorOnly:!0,descriptor:[{type:"object",shape:"{eventName: [...functions]}",keyName:"eventName",descriptor:[{type:"array",descriptor:[{type:"function"}]}]},{type:"false"}]},plugins:{constructorOnly:!0,descriptor:[{type:"array",descriptor:[{type:"function"}]},{type:"false"}]}};const y=class C extends T{constructor(){super(...arguments),this.eventList={},this.eventID=0}addEvent(e,t,s){if(T.selfCheckMethod("addEvent",arguments),!this.checkEventType(e)){const n="The specified event type ‘"+e+"’ is not valid. Available types are:"+l.arrayToListString(C.availableEventTypes);throw new l.Error(n,"addEvent")}Array.isArray(this.vals.events[e])||(this.vals.events[e]=[]),this.vals.events[e].push(t);const r=s||this.eventID,i={type:e,fn:t};return s?(Array.isArray(this.eventList[r])||(this.eventList[r]=[]),this.eventList[r].push(i)):this.eventList[r]=i,s||this.eventID++}removeEvent(e){if(T.selfCheckMethod("removeEvent",arguments),!(e in this.eventList))return!1;const t=this.eventList[e];return delete this.eventList[e],Array.isArray(t)?t.reduce(this.handleRemoveEvent.bind(this),[]):this.handleRemoveEvent([],t)}handleRemoveEvent(e,t){const s=t.type,r=this.vals.events[s],i=r.splice(r.indexOf(t.fn),1)[0];return r.length===0&&delete this.vals.events[s],e.push(i),e}invokeEvent(e,...t){if(t.unshift(this),this.vals.events!==!1&&e in this.vals.events)for(const s of this.vals.events[e])s(...t)}checkEventType(e){for(const t of Object.values(C.eventTypesSpecial))if(e.startsWith(t.prefix)){const s=e.slice(t.prefix.length);return t.fn(this,s,e),!0}return C.eventTypes.includes(e)}};y.eventTypes=["update","start","move","end"],y.eventTypesSpecial={"change:$property":{prefix:"change:",fn:(a,e,t)=>{if(!Object.prototype.hasOwnProperty.call(a.vals,e)){const s="‘"+t+"’ refers to ‘"+e+"’, which isn't a recognized property. Check its spelling and be aware that custom properties need to be initialized";throw new l.Error(s,"addEvent")}}}},y.availableEventTypes=y.eventTypes.concat(Object.keys(y.eventTypesSpecial));let F=y;class z extends F{defineDeepProperty(e,t,s,r,i){Object.defineProperty(e,t,{set:n=>{if(!this.initial)var o=i?Array.from(this[t]):this[t];if(s[t]=n,i){const h=this.properties[t];this.defineDeepArrayIntermediateVals(t,n),this.defineDeepArrayIntermediateThis(t,n,h.keySetter,h.keyGetter),this.handleInternalDeepArrayChange(t,o,n)}else this.handleInternalPropertyChange(t,o);r&&r(n,o)},get:()=>(i?this.vals.$intermediateVals:s)[t],enumerable:!0})}defineDeepArrayIntermediateThis(e,t,s,r){const i=this.vals;this.vals.$intermediateThis[e]=[];for(let n=0;n<t.length;n++){const o=t[n];Object.defineProperty(this.vals.$intermediateThis[e],n,{set:h=>{(!s||!s(h,n))&&(i[e][n]=h)},get:()=>r?r(i[e][n],n):i[e][n],enumerable:!0}),this.vals.$intermediateThis[e][n]=t[n]}}defineDeepArrayIntermediateVals(e,t){const s=this.vals.$;this.vals.$intermediateVals[e]=[];for(let r=0;r<t.length;r++){const i=t[r];Object.defineProperty(this.vals.$intermediateVals[e],r,{set:n=>{if(!this.initial)var o=Array.from(this[e]);s[e][r]=n,this.handleInternalDeepArrayChange(e,o,null,r)},get:()=>s[e][r],enumerable:!0})}}handleInternalPropertyChange(e,t,s=!1){!this.initial&&(typeof this[e]=="object"||t!==this[e])&&(this.domHandler.updatePotentialVariable(e),s||(t??(t=this[e]),this.invokeEvent("change:"+e,this[e],t)))}handleInternalDeepArrayChange(e,t,s,r){if(!this.initial)if(this.domHandler.updatePotentialVariable(e),r!=null)this.invokeDeepArrayChangeEvent(e,t,r);else for(let i=0;i<s.length;i++)this.invokeDeepArrayChangeEvent(e,t,i)}invokeDeepArrayChangeEvent(e,t,s){t[s]!==this[e][s]&&this.invokeEvent("change:"+e,this[e],t,s)}}var H=p(626),_=p.n(H);const P=class v{constructor(e){this.structureVars={},this.thumbChildren=[],this.vals=e}parseStructure(e,t){const s={slider:t};e=e.trim();for(const o in v.regex)v.regex[o].global&&(v.regex[o].lastIndex=0);const r=[];let i=0,n;for(;n=v.regex.tag.exec(e);){if(n.index!==i){const o="tag ‘<"+(n[1]||"")+n[2]+">’",h=e.slice(i,n.index).trim();throw new l.StructureParseError(o,h)}if(i=v.regex.tag.lastIndex,n[1]!=="/"){const o=r[r.length-1]||"slider",h=this.assembleElement(s,n[2],r,n[3],n[4],n[5]);s[n[2]]=h,s[o].appendChild(h),r.includes("thumb")&&this.thumbChildren.push(n[2]),n[1]==null&&r.push(n[2])}else{const o=r.pop();if(o!==n[2])if(r.indexOf(n[2])!==-1)this.closingTagError(o);else throw new l.StructureError("The closing tag ‘</"+n[2]+">’ couldn't find a matching opening tag")}}if(i!==e.length)throw new l.StructureParseError("end of string",e.slice(i));if(r.length>1)throw new l.StructureError("Couldn't find a matching closing tag for following elements:"+l.arrayToListString(r));return r.length===1&&this.closingTagError(r[0]),s}assembleElement(e,t,s,r,i,n){if(Object.prototype.hasOwnProperty.call(e,t))throw new l.StructureError("Every element must have a unique name but there are mutiple elements called ‘"+t+"’");const o=document.createElement(r||"div");if(i!=null){const h=document.createTextNode(i);h.textContent=i,o.appendChild(h),v.stringHasVariable(i)&&this.parseVariables(i,h,t,s)}if(n){let h;for(;h=v.regex.attributes.exec(n);){const S=h[1],d=h[2],f=document.createAttribute(S);f.textContent=d,o.setAttributeNode(f),v.stringHasVariable(d)&&this.parseVariables(d,f,t,s)}}return o}parseVariables(e,t,s,r){const i=[];let n;for(;n=v.regex.variable.exec(e);){const o=n[1]||n[2],h=o.indexOf(".")!==-1?o.slice(0,o.indexOf(".")):o;if(!i.hasOwnProperty(h)){if(!Object.prototype.hasOwnProperty.call(this.vals,h)&&!v.checkForSpecialVariables(h,s,r))throw new l.StructureError("‘"+h+"’ is not a recognized property and cannot be used as variable.Please check its spelling or initialize it in the constructor");this.registerVariable(h,e,t),i.push(h)}}}registerVariable(e,t,s){this.structureVars[e]==null&&(this.structureVars[e]={}),this.structureVars[e][t]==null&&(this.structureVars[e][t]=new Array),this.structureVars[e][t].push(s)}closingTagError(e){throw new l.StructureError("Couldn't find a closing tag for the element ‘<"+e+">’ (Should it be a self-closing tag marked with ‘:’?)")}static stringHasVariable(e){return v.regex.variableNoFlag.test(e)}static checkForSpecialVariables(e,t,s){if(Object.prototype.hasOwnProperty.call(v.specialVariables,e)){if(v.specialVariables[e].thumbOnly&&t!=="thumb"&&!s.includes("thumb"))throw new l.StructureError("The variable ‘$"+e+"’ may only be used inside the ‘<thumb>’ tag and its children (It was found in ‘<"+s[s.length-1]+">’)");return!0}return!1}};P.specialVariables={tag_node:{getter:a=>a},thumb_index:{thumbOnly:!0,getter:(a,e,t)=>e.nodes[t].indexOf(a)},thumb_value:{thumbOnly:!0,getter:(a,e,t)=>e.values[e.nodes[t].indexOf(a)]}},P.specialVariableProxy={values:["thumb_index","thumb_value"]},P.regex=function(){const a={attr:{name:"[\\w-]+"},all:"[\\d\\D]",capName:"([\\w-]+)"};a.attr.value="(?:(?!<)"+a.all+")*?",a.tagType="(?:\\s+"+a.capName+")?",a.content='(?:\\s+"('+a.all+'+?)")?',a.attribs="(?:\\s+"+a.attr.name+"=\\["+a.attr.value+"\\])*",a.varContent="\\$((?:\\w+(?:\\.(?=\\w))?)+)";const e={variable:"\\{"+a.varContent+"\\}|"+a.varContent,attributes:"("+a.attr.name+")=\\[("+a.attr.value+")\\](?:\\s+|$)",tag:"<([/:])?"+a.capName+a.tagType+a.content+"("+a.attribs+")\\s*?>\\s*"},t={};for(let s in e)t[s]=new RegExp(e[s],"g");return t.variableNoFlag=new RegExp(e.variable),t}();let b=P;const L=class E extends b{constructor(e,t){super(e),this.baseElements={},this.structureVarThumbStrings={},this.thumbEvents={},this.thumbEvents=t}createSliderNode(e,t,s){return t?this.createSliderFromStructure(e,t,s):this.createSliderManually(e,s)}createSliderManually(e,t){const s=document.createElement("div"),r={slider:[t],track:[s],thumb:new Array(e)};this.thumbBase=document.createElement("div"),this.thumbParent=s;for(let i=0;i<e;i++)r.thumb[i]=this.createNewThumb();return s.classList.add("sl89-track"),t.appendChild(s),r}createSliderFromStructure(e,t,s){const r=this.parseStructure(t,s);return this.parsePostProcess(r),this.expandThumbs(r,e)}expandThumbs(e,t){const s={thumb:[]};for(const[r,i]of Object.entries(e))this.thumbChildren.includes(r)?(this.baseElements[r]=e[r],s[r]=[]):r!=="thumb"&&(s[r]=[i]);this.findStructureVarStringsInThumb(this.thumbBase);for(let r=0;r<t;r++)this.addThumbToNode(s);return s}parsePostProcess(e){e.thumb?(this.thumbBase=e.thumb,e.track&&(this.thumbParent=e.thumb.parentElement),this.baseElements.thumb=this.thumbBase):this.thumbBase=this.assembleElement(e,"thumb",[],"div"),e.track||(e.track=this.assembleElement(e,"track",[],"div"),e.thumb?e.thumb.parentNode.appendChild(e.track):e.slider.appendChild(e.track)),e.thumb&&e.thumb.parentNode.removeChild(e.thumb),this.thumbParent||(this.thumbParent=e.track),e.track.classList.add("sl89-track")}findStructureVarStringsInThumb(e){for(const[t,s]of Object.entries(this.structureVars)){let r=[];for(const[i,n]of Object.entries(s))for(const o of n)if(this.nodeHasBaseElementOwner(o)){r.push(i);break}r.length>0&&(this.structureVarThumbStrings[t]=r)}}addThumbToNode(e){const t=this.createNewThumb();e.thumb.push(t),E.findNodeChildren(t).forEach((s,r)=>{const i=this.thumbChildren[r];e[i].push(s)})}removeThumbFromNode(e){for(const t of this.thumbChildren)e[t].pop();return e.thumb.pop()}addClasses(e,t,s,r){e.classList.add("slider89"),r&&e.classList.add("vertical"),s&&this.addClassesFromClassList(t,s)}addClassesFromClassList(e,t){const s=[];for(const[r,i]of Object.entries(t))if(!Object.prototype.hasOwnProperty.call(e,r))s.push(r);else if(s.length===0){const n=e[r];for(const o of i)for(const h of Object.values(n))h.classList.add(o)}if(s.length>0){const r="The given object contains items which aren't nodes of this slider:"+l.arrayToListString(s)+"Following nodes are part of this slider's node pool:"+l.arrayToListString(Object.keys(e));throw new l.Error(r,"classList",!0)}}createNewThumb(){const e=this.thumbBase.cloneNode(!0);e.classList.add("sl89-thumb"),e.tabIndex===-1&&(e.tabIndex=0);for(const[t,s]of Object.entries(this.thumbEvents))e.addEventListener(t,s,{passive:!(t.startsWith("touch")||t.startsWith("key"))});return this.thumbParent.appendChild(e),e}nodeHasBaseElementOwner(e){for(const[t,s]of Object.entries(this.baseElements))if(E.getNodeOwner(e)===s)return t;return!1}static getNodeOwner(e){return e.ownerElement||e.parentElement}static injectStyleSheetIfNeeded(){if(E.hasInjectedStylesheet===!1){const e=document.createElement("style"),t=document.head.firstElementChild;e.textContent=_(),t?document.head.insertBefore(e,t):document.head.appendChild(e),E.hasInjectedStylesheet=!0}}static findNodeChildren(e,t=[]){if(e.childElementCount===0)return t;for(const s of e.children)t.push(s),E.findNodeChildren(s,t);return t}};L.hasInjectedStylesheet=!1;let N=L;var $=(a,e,t)=>{if(!e.has(a))throw TypeError("Cannot "+t)},W=(a,e,t)=>{if(e.has(a))throw TypeError("Cannot add the same private member more than once");e instanceof WeakSet?e.add(a):e.set(a,t)},q=(a,e,t)=>($(a,e,"access private method"),t),A,R;class U extends N{constructor(e,t,s){super(t,s),W(this,A),this.slider=e}updatePotentialVariable(e){if(Object.prototype.hasOwnProperty.call(this.structureVars,e)){for(const[t,s]of Object.entries(this.structureVars[e]))this.replaceVariableStringInNodes(t,s);if(Object.prototype.hasOwnProperty.call(b.specialVariableProxy,e))for(const t of b.specialVariableProxy[e])this.updatePotentialVariable(t)}}updateAllVariables(){if(this.vals.structure!==!1)for(const e in this.structureVars)this.updatePotentialVariable(e)}expandAllBaseElementVariables(){for(const[e,t]of Object.entries(this.structureVarThumbStrings))for(const s of t){const r=this.structureVars[e][s];this.replaceVariableStringInNodes(s,r)}}replaceVariableStringInNodes(e,t){for(const[s,r,i]of q(this,A,R).call(this,t))r.textContent=e.replace(b.regex.variable,(n,o,h)=>this.getValueFromVariableName(o||h,s,i))}getValueFromVariableName(e,t,s){const r=e.split(".").values(),i=r.next().value;let n;i in b.specialVariables?n=b.specialVariables[i].getter(t,this.slider,s):n=this.slider[i];for(const o of r)try{n=n[o]}catch{throw new l.StructureError("Variable ‘"+e+"’ cannot access property ‘"+o+"’ on "+n)}return n}}A=new WeakSet,R=function*(a){for(const e of a){const t=this.nodeHasBaseElementOwner(e);if(t){const s=this.vals.nodes[t];if(e.nodeType===Node.ATTRIBUTE_NODE)for(const r of s)yield[r,r.getAttributeNode(e.name),t];else for(const r of s)yield[r,r.childNodes[0],t]}else yield[N.getNodeOwner(e),e,t]}};var G=(a,e,t)=>{if(!e.has(a))throw TypeError("Cannot "+t)},K=(a,e,t)=>{if(e.has(a))throw TypeError("Cannot add the same private member more than once");e instanceof WeakSet?e.add(a):e.set(a,t)},B=(a,e,t)=>(G(a,e,"access private method"),t),x,M;class X extends z{constructor(){super(),K(this,x),this.activeTouchIDs=new Map,this.mouseStart=this.mouseStart.bind(this),this.mouseMove=this.mouseMove.bind(this),this.mouseEnd=this.mouseEnd.bind(this),this.touchStart=this.touchStart.bind(this),this.touchMove=this.touchMove.bind(this),this.touchEnd=this.touchEnd.bind(this),this.keyDown=this.keyDown.bind(this),this.domHandler=new U(this,this.vals,{touchstart:this.touchStart,mousedown:this.mouseStart,keydown:this.keyDown})}getTrackPadding(e){return parseFloat(this.trackStyle.getPropertyValue("padding-"+e))}getTrackOffset(e){return parseFloat(this.trackStyle.getPropertyValue("border-"+e+"-width"))+this.getTrackPadding(e)}getDistance(e){return this.vals.orientation==="vertical"?e.getBoundingClientRect().top-this.vals.node.track.getBoundingClientRect().top-this.getTrackOffset("top"):e.getBoundingClientRect().left-this.vals.node.track.getBoundingClientRect().left-this.getTrackOffset("left")}getAbsoluteTrackSize(e){return this.vals.orientation==="vertical"?this.vals.node.track.getBoundingClientRect().height-this.getTrackOffset("top")-this.getTrackOffset("bottom")-e.getBoundingClientRect().height:this.vals.node.track.getBoundingClientRect().width-this.getTrackOffset("left")-this.getTrackOffset("right")-e.getBoundingClientRect().width}moveThumbTranslate(e,t){const s=this.vals.orientation==="vertical"?"Y":"X";e.style.transform="translate"+s+"("+t+"px)"}moveThumbRelative(e,t){if(this.vals.orientation==="vertical")var s="top",r=this.getTrackPadding("top"),i=this.getTrackPadding("bottom"),n=e.clientHeight;else var s="left",r=this.getTrackPadding("left"),i=this.getTrackPadding("right"),n=e.clientWidth;let o=n*t+"px";i&&(o+=" - "+i*t+"px"),r&&(o+=" + "+r*(1-t)+"px"),e.style[s]="calc("+t*100+"% - "+o+")"}applyAllRatioDistances(e){for(let t=0;t<this.vals.values.length;t++)this.applyOneRatioDistance(t,e)}applyOneRatioDistance(e,t){const{value:s,prevRatio:r,ratio:i}=this.computeRatioDistance(e,t);this.setValuesWithValueChange(e,s),l.floatIsEqual(i,r)||this.moveThumbRelative(this.vals.nodes.thumb[e],i)}computeDistanceValue(e,t,s){return s==null&&(s=this.getAbsoluteTrackSize(e)),t/s*(this.vals.range[1]-this.vals.range[0])+this.vals.range[0]}computeRatioDistance(e,t){let s,r;if(!t)t=this.vals,s=this.vals.values[e];else{for(let n of["range","step"])t[n]==null&&(t[n]=this.vals[n]);t.value!=null?s=t.value:(r=(this.vals.values[e]-this.vals.range[0])/(this.vals.range[1]-this.vals.range[0]),s=(t.range[1]-t.range[0])*r+t.range[0])}t.step!==!1&&(typeof t.step=="number"?Math.abs(t.range[1]-t.range[0])<t.step?s=t.range[0]:s=t.range[0]+Math.round((s-t.range[0])/t.step)*t.step:s=l.getClosestNumber(s,t.step));const i=(s-t.range[0])/(t.range[1]-t.range[0]);return{value:s,prevRatio:r,ratio:i}}removeLastThumbNode(){const e=this.domHandler.removeThumbFromNode(this.vals.nodes);this.domHandler.thumbParent.removeChild(e)}appendNewThumbNode(){this.domHandler.addThumbToNode(this.vals.nodes),this.applyOneRatioDistance(this.vals.nodes.thumb.length-1)}changeOrientationDOM(e){e==="vertical"?(B(this,x,M).call(this,"left"),this.vals.node.slider.classList.add("vertical")):(B(this,x,M).call(this,"top"),this.vals.node.slider.classList.remove("vertical"))}setValuesWithValueChange(e,t,...s){const r=this.vals.values[e],i=this.values[e];if(!l.floatIsEqual(t,r)){this.vals.values[e]=t,e===0&&this.handleInternalPropertyChange("value",r);const n=this.values[e];return l.floatIsEqual(n,i)||this.invokeEvent("update",n,i,e,...s),!0}return!1}touchStart(e){e.preventDefault();const t=e.changedTouches[0];if(!this.activeTouchIDs.has(t.identifier)){const s=e.currentTarget;this.activeTouchIDs.set(t.identifier,s),this.slideStart(s,t,e),s.addEventListener("touchmove",this.touchMove,{passive:!1}),s.addEventListener("touchend",this.touchEnd),s.addEventListener("touchcancel",this.touchEnd)}}touchMove(e){e.preventDefault();for(const t of e.changedTouches)if(this.activeTouchIDs.has(t.identifier)){const s=this.activeTouchIDs.get(t.identifier);this.slideMove(s,t,e)}}touchEnd(e){e.preventDefault();for(const t of e.changedTouches)if(this.activeTouchIDs.has(t.identifier)){const s=this.activeTouchIDs.get(t.identifier);this.activeTouchIDs.delete(t.identifier),this.slideEnd(s,t,e),s.removeEventListener("touchmove",this.touchMove,{passive:!1}),s.removeEventListener("touchend",this.touchEnd),s.removeEventListener("touchcancel",this.touchEnd)}}mouseStart(e){const t=e.currentTarget;document.body.classList.add("sl89-noselect"),this.slideStart(t,e,e),this.activeThumb||(this.activeThumb=t,window.addEventListener("mousemove",this.mouseMove),window.addEventListener("mouseup",this.mouseEnd))}mouseMove(e){this.slideMove(this.activeThumb,e,e)}mouseEnd(e){this.slideEnd(this.activeThumb,e,e),window.removeEventListener("mousemove",this.mouseMove),window.removeEventListener("mouseup",this.mouseEnd),this.activeThumb=null}slideStart(e,t,s){const r=this.vals.nodes.thumb.indexOf(e),i=this.getDistance(e);if(e.classList.add("active"),this.vals.orientation==="vertical")var n="top",o=t.clientY;else var n="left",o=t.clientX;this.mouseDownPos=o-i,this.moveThumbTranslate(e,i),this.invokeEvent("start",r,s),e.style.removeProperty(n)}slideMove(e,t,s){const r=this.vals.nodes.thumb.indexOf(e),i=this.getAbsoluteTrackSize(e);let n=(this.vals.orientation==="vertical"?t.clientY:t.clientX)-this.mouseDownPos;n>i?n=i:n<0&&(n=0);let o=this.computeDistanceValue(e,n,i);if(this.vals.step!==!1){const h=this.computeRatioDistance(r,{value:o});o=h.value,n=h.ratio*i}this.setValuesWithValueChange(r,o,s)&&(this.moveThumbTranslate(e,n),this.invokeEvent("move",r,s))}slideEnd(e,t,s){const r=this.vals.nodes.thumb.indexOf(e);this.applyOneRatioDistance(r),e.style.removeProperty("transform"),this.invokeEvent("end",r,s),e.classList.remove("active"),document.body.classList.remove("sl89-noselect"),this.mouseDownPos=null}keyDown(e){if(!e.key.startsWith("Arrow"))return;const t=this.vals.nodes.thumb.indexOf(e.currentTarget);let s=Math.round((this.vals.range[1]-this.vals.range[0])/100);e.shiftKey&&e.ctrlKey?s*=.1:e.shiftKey&&(s*=10),e.key==="ArrowLeft"||e.key==="ArrowUp"?(e.preventDefault(),this.values[t]-=s):(e.key==="ArrowRight"||e.key==="ArrowDown")&&(e.preventDefault(),this.values[t]+=s)}}x=new WeakSet,M=function(a){for(const e of this.vals.nodes.thumb)e.style.removeProperty(a)};class l extends X{constructor(e,t,s=!1){super(),this.methods={addEvent:{funct:this.addEvent},removeEvent:{funct:this.removeEvent}},this.properties={range:{default:[0,100],setter:r=>{if(r[0]===r[1])throw new l.PropertyError(this,"range","The given range of ["+r.join(", ")+"] defines the same value for both range start and end");this.initial||this.applyAllRatioDistances({range:r})},keySetter:(r,i)=>{if(r===this.vals.range[Math.abs(i-1)])throw new l.PropertyError(this,"range","The new range of ["+r+", "+r+"] defines the same value for both range start and end");if(!this.initial){const n=Array.from(this.vals.range);n[i]=r,this.applyAllRatioDistances({range:n})}}},values:{default:()=>[this.vals.range[0]],setter:r=>{if(!this.initial){if(r.length>this.vals.values.length)for(let i=this.vals.values.length;i<r.length;i++)this.appendNewThumbNode();else if(r.length<this.vals.values.length)for(let i=r.length;i<this.vals.values.length;i++)this.removeLastThumbNode()}},postSetter:(r,i)=>{if(!this.initial){const n=i.length!==r.length;this.handleInternalPropertyChange("value",i[0]),this.handleInternalPropertyChange("node",null,!n),this.handleInternalPropertyChange("nodes",null,!n),this.domHandler.expandAllBaseElementVariables()}},keySetter:(r,i)=>(r=this.adaptValueToRange(r),this.initial?this.vals.values[i]=r:this.applyOneRatioDistance(i,{value:r}),!0),keyGetter:(r,i)=>this.vals.precision!==!1?Number(r.toFixed(this.vals.precision)):r},value:{setter:r=>(this.values[0]=r,!0),getter:r=>this.values[0]},precision:{default:!1,setter:r=>{this.initial||this.applyAllRatioDistances()}},step:{default:!1,setter:r=>{if(this.vals.precision!==!1&&typeof r=="number"&&Number(r.toFixed(this.vals.precision))!==r)throw new l.PropertyError(this,"step","The given value of "+r+" exceeds the currently set precision of "+this.vals.precision);this.initial||this.applyAllRatioDistances({step:r})}},structure:{default:!1},node:{default:{}},nodes:{default:{}},orientation:{default:"horizontal",setter:r=>{if(!this.initial)return this.changeOrientationDOM(r),this.vals.orientation=r,this.applyAllRatioDistances(),!0}},classList:{default:!1},events:{default:{},setter:r=>{if(r!==!1){const i=[];for(let n in r)this.checkEventType(n)||i.push(n);if(i.length>0)throw new l.PropertyError(this,"events","The given object contains items which are no valid event types:"+l.arrayToListString(i)+"Available event types are:"+l.arrayToListString(l.availableEventTypes))}}},plugins:{default:!1}},this.initial=!0,this.testInitialTarget(e),(t==null||t===!1)&&(t={}),this.testInitialConfig(t),this.initializeClassProperties(t),this.initializeCustomProperties(t),this.buildSlider(e,s),this.applyAllRatioDistances(),this.domHandler.updateAllVariables(),this.initial=!1,this.callPlugins(this.vals.plugins)}testInitialTarget(e){if(e){if(!e.nodeType||e.nodeType!==1)throw new l.InitializationError("The first argument must be a valid DOM node (got "+u.getType(e)+")")}else throw new l.InitializationError("No first argument has been supplied. It needs to be the DOM target node for the slider")}testInitialConfig(e){if(typeof e!="object"||Array.isArray(e))throw new l.InitializationError("The optional second argument needs to be a configuration object (got "+u.getType(e)+")");if("value"in e&&"values"in e)throw new l.InitializationError("Only one of ‘value’ and ‘values’ may be defined at once")}initializeClassProperties(e){for(const[t,s]of Object.entries(this.properties))if(this.initializeProperty(t,s),t in e)this[t]=e[t],delete e[t];else if("default"in s){const r=s.default;(s.getter||s.keyGetter?this:this.vals)[t]=typeof r=="function"?r():r}}initializeCustomProperties(e){for(const t in e)if(t[0]==="_")this.defineDeepProperty(this,t,this.vals),this.vals[t]=e[t];else throw new l.InitializationError("‘"+t+"’ is not a valid property name. Check its spelling or prefix it with an underscore to use it as custom property (‘_"+t+"’)")}buildSlider(e,t){const s=t?e:document.createElement("div");this.vals.nodes=this.domHandler.createSliderNode(this.vals.values.length,this.vals.structure,s),this.defineNodeGetters(this.vals.nodes),t||e.appendChild(this.vals.node.slider),this.domHandler.addClasses(this.vals.node.slider,this.vals.nodes,this.vals.classList,this.vals.orientation==="vertical"),N.injectStyleSheetIfNeeded(),this.trackStyle=getComputedStyle(this.vals.node.track)}callPlugins(e){if(e!==!1)for(const t of e)t(this)}initializeProperty(e,t){const s=l.propertyData[e],r="isDeepDefinedArray"in s;Object.defineProperty(this,e,{set:i=>{if("readonly"in s)throw new l.Error("Property ‘"+e+"’ is read-only (It was just set with the value ‘"+i+"’)");if("constructorOnly"in s&&!this.initial)throw new l.Error("Property ‘"+e+"’ may only be defined in the constructor (It was just set with the value ‘"+i+"’)");this.checkProp(e,i),(!t.setter||!t.setter(i))&&(this.vals[e]=i)},get:()=>{const i=r?this.vals.$intermediateThis:this.vals;return t.getter?t.getter(i[e]):i[e]},enumerable:!0}),this.defineDeepProperty(this.vals,e,this.vals.$,t.postSetter,r)}defineNodeGetters(e){for(const t in e)Object.defineProperty(this.vals.node,t,{get:()=>e[t][0],enumerable:!0})}checkProp(e,t){const s=l.propertyData[e],r=u.checkTypes(t,s.descriptor);if(r)throw new l.PropertyTypeError(this,e,s,r)}adaptValueToRange(e){if(this.vals.range[0]<this.vals.range[1]){if(e<this.vals.range[0])return this.vals.range[0];if(e>this.vals.range[1])return this.vals.range[1]}else{if(e>this.vals.range[0])return this.vals.range[0];if(e<this.vals.range[1])return this.vals.range[1]}return e}static floatIsEqual(e,t){return Math.abs(e-t)<1e-11}static getClosestNumber(e,t){return t.reduce((s,r)=>Math.abs(s-e)<Math.abs(r-e)?s:r)}}}(),D=D.default,D}()});
